<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="949.54">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 12.0px Helvetica; min-height: 14.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
  </style>
</head>
<body>
<p class="p1"><b>Project 5 Corrections and Clarifications</b></p>
<p class="p1"><b>Updated 4/2/10</b></p>
<p class="p1"><b>Most recent items appear first</b></p>
<p class="p1"><b>Page numbers refer to the pdf document</b></p>
<p class="p2"><br></p>
<p class="p1"><b>NOTICE:</b></p>
<p class="p1"><b>This document is part of the project specifications.</b></p>
<p class="p1"><b>Your solution must follow these corrections and clarifications.</b></p>
<p class="p3"><br></p>
<p class="p4"><b>Files to submit. Before you submit your project, check the project 4 specifications about files to submit.</b></p>
<p class="p4">You were supposed to submit all of the specified files for Project 4, but the autograder overwrote the supplied files to ensure that your code had access to only unmodified versions, so you might not have noticed before that these were required. You must submit all of the code files for project 5 - do not assume that any are supplied by the autograder.</p>
<p class="p3"><br></p>
<p class="p3"><br></p>
<p class="p4"><b>Further clarification of Cruise_ship clarifications,</b></p>
<p class="p4">If you give valid movement commands, the Cruise_ship always cancels the current cruise and starts a new one. The intent of the clarifications was different. More explanation:</p>
<p class="p3"><br></p>
<p class="p4">Start with just a generic Ship. If it is on its way somewhere, and you tell it to go somewhere else at an impossibly high speed, it throws an exception and does not change what it is doing. That's the oldest P3 C&amp;C item below.</p>
<p class="p3"><br></p>
<p class="p4">A cruise ship always cancels any cruise first thing when you tell it to go somewhere; the validity of the movement is not checked before canceling the cruise. Cancelling the cruise does not make the ship stop moving, or start moving, or change how it is moving - it just causes it to forget that it is on a cruise that starts and stops at a certain island, with certain islands left to visit, etc. This is the newer P.3 C&amp;C item below.</p>
<p class="p3"><br></p>
<p class="p4">So if a cruise ship is on a cruise and moving, and you tell it to go somewhere else at an impossibly high speed, the cruise ship cancels the cruise, but the bogus speed causes the Ship part to throw the exception, and the ship continues to move as it was before - but it is no longer on a cruise. If you give it a valid movement command, it cancels the current cruise and starts a new one based on the movement command.</p>
<p class="p3"><br></p>
<p class="p4"><b>Project 4 doc, Ship::set_destination_and_speed; Possible floating point issue in view plotting.</b></p>
<p class="p4">When you set a ship's course, the easy way to do it is by constructing a Compass_vector with the first argument being this Ship's location and the second argument being the destination position (both are Points). Then get the direction member from the Compass_vector and use this directly to set the course with Track_base::set_course(). If you compute the course by some other method, there <i>might</i> be a tiny difference in the course value, which <i>might</i> affect which bin your view code puts the Ship or Island in. To be sure these calculations take the same sequence of operations, you should use this method to compute the course (see related FAQ item).</p>
<p class="p3"><br></p>
<p class="p4">Here is a test case for the calculation: create a ship at location (13, 8). Set to go to Treasure Island at 10 knots. "go" until the ship is at (32.93, 6.38). Using the debugger inside your bridge_view code, the angle from the ship to the Island should be 94. 6354...., and the Ship's course should be a very similar number. The angle on the bow should thus be a very, very small number, often it is something like -5. X 10^-14. If it is slightly negative, your code should put it into subscript bin 8. If it is slightly positive, it should go into bin 9.</p>
<p class="p3"><br></p>
<p class="p3"><br></p>
<p class="p4"><b>P. 3. Cruise cancellation. </b>If you start a Cruise_ship on a cruise with a navigation command, then giving it another navigation command will first and unconditionally cancel the cruise. Canceling the cruise causes the ship to forget where it has been, and where the cruise is supposed to end. It does not however cancel the movement that the original navigation command started - the ship will continue to the original Island location.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 3. Ship Error Handling.</b></p>
<p class="p4">Refer to the Error handling and navigation command sections of Project 4, and the above item. if you give a ship a navigation command and it starts moving, and then give another navigation command that throws an Error because the speed is too high, the ship will be left in whatever movement state it was in.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 5, Project Evaluation. Embarrassing residue from ancient history.</b></p>
<p class="p4">Ignore the statement about the project 5 instructor solution not being posted. I recycled a big chunk of this project document from a long time ago, and missed this left-over bit. Ask me if you want to know about the changes in course policy involved.</p>
<p class="p3"><br></p>
<p class="p4"><b>UPDATE: Views sample. Trailing spaces after the "90".</b></p>
<p class="p4">The Views sample unfortunately was generated by code that produced two spaces after the "90" on the x-axis labels. However, according to my checks, the autograder will not hold absence of those trailing spaces against you, so you can either reproduce the trailing spaces or not.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 4. Clarification of Views design constraint #2. At least two classes are required.</b></p>
<p class="p4">That is, the two kinds of views must be separate classes, but you can have more than two classes for views in your design.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 4. Clarification of Views design constraint #4. It applies after you have implemented the two kinds of views and within the scope of their interface.</b></p>
<p class="p4">That is, if we added a third kind of view that uses the same update functions, it should be possible with no change in Model at all.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 4. Results of "show" if no views are open is no output.</b></p>
<p class="p4">No output at all; no error messages, nothing.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 4. Order of input and error checks for map view parameter commands.</b></p>
<p class="p4">Check for the map_view being open first, then read and check each parameter value.</p>
<p class="p3"><br></p>
<p class="p4"><b>Views sample. Trailing spaces after the "90".</b></p>
<p class="p4">The Views sample unfortunately was generated by code that produced two spaces after the "90" on the x-axis labels. Given that this did not surface until now, please include this unnecessary aspect of the output in your code.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 1,2, 4; Steps 2, 3, 4. Smart pointer requirement does not apply to the Singleton.</b></p>
<p class="p4">Step 2 asks you to use smart pointers for all Sim_object family objects. Step 4 asks you to use smart pointers for all View objects. Step 3 asks you to make Model into a Singleton, whose implementation can involve a pointer to Model.</p>
<p class="p3"><br></p>
<p class="p4">Item #6 in Step 4 (p. 4) says "no deletes should be present anywhere in your program" but goes on to say that the Singleton implementation is the only possible exception. Note that Model is not in either the Sim_object family or View family, so there no requirement that you point to Model with a smart pointer. A Model * is the only possible raw pointer type that your program might declare, and a delete of a Model * is the only possible appearance of "delete" in your code. (If you use a Meyer's Singleton, you won't have either one.)</p>
<p class="p3"><br></p>
<p class="p4">The point of smart pointers is to automate keeping track of when to delete an object. However, a Singleton's lifetime is not something that needs to be automatically tracked by smart pointers - the whole logic of the Singleton is that it gets created when needed, and destroyed at program shutdown. So do not attempt to point to the Singleton with a smart pointer - it simply doesn't make sense to do it, and in fact the code won't compile with an otherwise correctly defined Singleton.</p>
<p class="p3"><br></p>
<p class="p4"><b>P. 1, Step 1. Remove constness from Warship::fire_at_target().</b></p>
<p class="p4">When you modify this function, you must make it no longer const. This is because it is going to hand "this" to the target Ship, which in term may fire back at it - a non-const operation.</p>
<p class="p4"><i>Change:</i></p>
<p class="p4">Change Warship::fire_at_target so that it supplies "this" as the second argument when it calls receive_hit on its target.</p>
<p class="p4"><i>To:</i></p>
<p class="p4">Change Warship::fire_at_target so that it is a non-const member function and supplies "this" as the second argument when it calls receive_hit on its target.</p>
<p class="p4"><i>Explanation:</i></p>
<p class="p4">Error on my part; I had forgotten to put this in the spec document after making the change (with a comment!) in my code.</p>
<p class="p4"><i>More:</i></p>
<p class="p4">If you had fixed this with e.g. a const_cast, you were making a fundamental mistake. Remember that a const_cast (and most other casts) in C++ are usually signals of a design error. There is definitely a design problem here because in the nature of things, the attacking Warship must be modifiable, so it can not be const when it makes an attack, and you shouldn't try to pretend that it is. "If you lie to the compiler, eventually it will get its revenge."</p>
<p class="p3"><br></p>
<p class="p4">As in this case, the design or simply the specifications might be wrong, and your response should be to question them, and try to get the design problem (or specifications) fixed, not plaster over the error by lying to the compiler.</p>
<p class="p3"><br></p>
<p class="p4">Thanks are due to the student who called this to my attention - which everybody should have done.</p>
<p class="p3"><br></p>
</body>
</html>
