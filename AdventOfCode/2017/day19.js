/*
--- Day 19: A Series of Tubes ---
Somehow, a network packet got lost and ended up here. It's trying to follow a routing diagram (your puzzle input), but it's confused about where to go.

Its starting point is just off the top of the diagram. Lines (drawn with |, -, and +) show the path it needs to take, starting by going down onto the only line connected to the top of the diagram. It needs to follow this path until it reaches the end (located somewhere within the diagram) and stop there.

Sometimes, the lines cross over each other; in these cases, it needs to continue going the same direction, and only turn left or right when there's no other option. In addition, someone has left letters on the line; these also don't change its direction, but it can use them to keep track of where it's been. For example:

     |
     |  +--+
     A  |  C
 F---|----E|--+
     |  |  |  D
     +B-+  +--+

Given this diagram, the packet needs to take the following path:
- Starting at the only line touching the top of the diagram, it must go down, pass through A, and continue onward to the first +.
- Travel right, up, and right, passing through B in the process.
- Continue down (collecting C), right, and up (collecting D).
- Finally, go all the way left through E and stopping at F.

Following the path to the end, the letters it sees on its path are ABCDEF.

The little packet looks up at you, hoping you can help it find the way. What letters will it see (in the order it would see them) if it follows the path? (The routing diagram is very wide; make sure you view it without line wrapping.)
 */

const Utils = require('./utils.js');

function part1(input) {
    const continueDir = /[|-]/;
    const letter = /[A-Z]/;
    let maze = {};

    // Parse input and create maze
    let lines = input.split('\n');
    let width = lines[0].length;
    let height = lines.length;
    let startX = 0;

    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            let char = lines[y].charAt(x);

            if (char !== ' ') {
                maze[x + '_' + y] = char;

                if (y === 0) {
                    startX = x;
                }
            }
        }
    }

    printMaze(maze, width, height);

    let dir = 'down';
    let x = startX;
    let y = 0;
    let result = '';

    while (true) {
        let value = maze[x + '_' + y];

        if (!value) {
            break;
        }

        switch (dir) {
            case 'up':
                if (continueDir.test(value)) {
                    y--;
                } else if (letter.test(value)) {
                    result += value;
                    y--;
                } else if (value === '+') {
                    let neighbors = getNeighborValues(maze, x, y);
                    if (neighbors[0]) {
                        y--;
                    } else if (neighbors[1]) {
                        dir = 'right';
                        x++;
                    } else if (neighbors[3]) {
                        dir = 'left';
                        x--;
                    } else {
                        throw Error('Invalid input');
                    }
                } else {
                    throw Error('Invalid input');
                }
                break;
            case 'right':
                if (continueDir.test(value)) {
                    x++;
                } else if (letter.test(value)) {
                    result += value;
                    x++;
                } else if (value === '+') {
                    let neighbors = getNeighborValues(maze, x, y);
                    if (neighbors[1]) {
                        x++;
                    } else if (neighbors[0]) {
                        dir = 'up';
                        y--;
                    } else if (neighbors[2]) {
                        dir = 'down';
                        y++;
                    } else {
                        throw Error('Invalid input');
                    }
                } else {
                    throw Error('Invalid input');
                }
                break;
            case 'down':
                if (continueDir.test(value)) {
                    y++;
                } else if (letter.test(value)) {
                    result += value;
                    y++;
                } else if (value === '+') {
                    let neighbors = getNeighborValues(maze, x, y);
                    if (neighbors[2]) {
                        y--;
                    } else if (neighbors[1]) {
                        dir = 'right';
                        x++;
                    } else if (neighbors[3]) {
                        dir = 'left';
                        x--;
                    } else {
                        throw Error('Invalid input');
                    }
                } else {
                    throw Error('Invalid input');
                }
                break;
            case 'left':
                if (continueDir.test(value)) {
                    x--;
                } else if (letter.test(value)) {
                    result += value;
                    x--;
                } else if (value === '+') {
                    let neighbors = getNeighborValues(maze, x, y);
                    if (neighbors[3]) {
                        x--;
                    } else if (neighbors[0]) {
                        dir = 'up';
                        y--;
                    } else if (neighbors[2]) {
                        dir = 'down';
                        y++;
                    } else {
                        throw Error('Invalid input');
                    }
                } else {
                    throw Error('Invalid input');
                }
                break;
        }
    }

    return result;
}

function getNeighborValues(maze, x, y) {
    return [
        maze[x + '_' + (y - 1)],
        maze[(x + 1) + '_' + y],
        maze[x + '_' + (y + 1)],
        maze[(x - 1) + '_' + y]
    ];
}

function printMaze(maze, width, height) {
    for (let y = 0; y < height; y++) {
        let line = '';
        for (let x = 0; x < width; x++) {
            line += maze[x + '_' + y] || ' ';
        }
        console.log(line);
    }
}

function runPart1() {
    Utils.assertAreEqual('ABCDEF', part1('     |          \n     |  +--+    \n     A  |  C    \n F---|----E|--+ \n     |  |  |  D \n     +B-+  +--+ '));

    // Answer: EOCZQMURF
    console.log(part1(' |                                                                                                                                                                                                       \n |               +-------------------------------------------------------------+     +-------------------------------------------------+ +---+ +---------------------------------------------+   +-----+ \n |               |                                                             |     |                                                 | |   | |                                             |   |     | \n |               +---------------------------------------------------------------------------------------------------------------------|---------------------------------------------------+ |   |     | \n |                                                                             |     |                                                 | |   | |                                           | |   |     | \n +-----------------------------------------------------------------------------|-----------------------------------------------------------------------------------+                       | |   |     | \n                                                                               |     |                                                 | |   | |                   |                       | |   |     | \n                         +-----------------------------------------------------|-----|---------------------------------------------------|-----+   +---------------|---------------------+ | |   |     | \n                         |                                                     |     |                                                 | |   |     |               |                     | | |   |     | \n     +-------------------------------------------------------------------------------|-------------------------------------------------|-|---------|---------------------------------------------|---+ | \n     |                   |                                                     |     |                                                 | |   |     |               |                     | | |   |   | | \n     |                   |               +---+                         +---+ +-------|-------------------+                             | |   |     |               | +-------------+     | | |   |   | | \n     |                   |               |   |                         |   | | |     |                   |                             | |   |     |               | |             |     | | |   |   | | \n     |                   |               |   +-----------------------------|-|---------------------------|-----------------------------|-|---|-----------------------|-------------|-------|-|---|---+ | \n     |                   |               |                             |   | | |     |                   |                             | |   |     |               | |             |     | | |   |     | \n +-------------+         +---------------------------------------------|-----|-|---------------------------------------------------+ +---+   |     | +-------------|---------------|-----+ | |   |     | \n |   |         |                         |                             |   | | |     |                   |                         | | |     |     | |             | |             |       | |   |     | \n |   |         |                         |           +---------------------+ | |     |         +---------|-------------------------+ | |     |     | |             | |             |       | |   |     | \n |   |         |                         |           |                 |     | |     |         |         |                           | |     |     | |             | |             |       | |   |     | \n |   |         +-------------------------|-----------------------------|-----|-|---------------|-------------------------------+   +-|-|-+   |     | |             | |             |       | |   |     | \n |   |                                   |           |                 |     | |     |         |         |                     |   | | | |   |     | |             | |             |       | |   |     | \n |   |                                 +-|-----------|-----------------|-----|---------------------------------------+         |   | | | |   |     | |             | |             |       | |   |     | \n |   |                                 | |           |                 |     | |     |         |         |           |         |   | | | |   |     | |             | |             |       | |   |     | \n |   |                 +---------+     | |         +-|-----------------|-----|-------|---------|---------------------+         |   | | | |   +-------|---------------|-+     +-----+       | |   |     | \n |   |                 |         |     | |         | |                 |     | |     |         |         |                     |   | | | |         | |             | | |     |             | |   |     | \n |   |                 |         |     | |         | |     +-----------|-----|-----------------|-------+ +---------------------------|-|---------------------------|-|-|---+ |             | |   |     | \n |   |                 |         |     | |         | |     |           |     | |     |         |       |                       |   | | | |         | |             | | |   | |             | |   |     | \n |   |                 |         |     | |         | | +---|-------+   | +---|-------|---------|-------|-----------------------------|---|U------------------------|-------|---------+     | |   |     | \n |   |                 |         |     | |         | | |   |       |   | |   | |     |         |       |                       |   | | | |         | |             | | |   | |       |     | |   |     | \n |   |                 |         |     | |         +---|-----------|---|-------|-----|-----------------|-----------------------------|-|-------------|----O------------|-+ | |       |     | |   |     | \n |   |                 |         |     | |           | |   |       |   | |   | |     |         |       |                       |   | | | |         | |             | | | | | |       |     | |   |     | \n |   |             +---------+   |     | |   +---------|---|-----+ |   | |   | | +-------------|-----------------------------------|-|-|-|-----------|-----+       | | +---+ |       |     | |   |     | \n |   |             |   |     |   |     | |   |       | |   |     | |   | |   | | |   |         |       |                       |   | | | |         | |     |       | |   |   |       |     | |   |     | \n |   |             |   |     |   |     | |   |       | |   |     | |   | +-----|-|---|---------|-------|-----------------------|---------------------|-----|-----------+ |   |       |     | |   |     | \n |   |             |   |     |   |     | |   |       | |   |     | |   |     | | |   |         |       |                       |   | | | |         | |     |       | | | |   |       |     | |   |     | \n |   |             |   |     |   |     | |   |   +---|-|---|-------|-------------|---------------------|-----------------------------|---|-------+ | |     |       | | | |   |     +-|-+   | |   |     | \n |   |             |   |     |   |     | |   |   |   | |   |     | |   |     | | |   |         |       |                       |   | | | |       | | |     |       | | | |   |     | | |   | |   |     | \n |   |             |   |     |   |     | |   |   |   +-|---|-----|-|-------------|---|-----------------|-----------------------|---|-------------|---|-------------------|-----+   | | |   | |   |     | \n |   |             |   |     |   |     | |   |   |     |   |     | |   |     | | |   |         |       |                       |   | | | |       | | |     |       | | | |   | |   | | |   | |   |     | \n |   |             |   |     |   |   +---|-----+ |     |   | +---------|-------------|-----------------|-----------------+     |   | | | |       | | |     |       | | | |   +-----|-------|-|-+ |     | \n |   |             |   |     |   |   | | |   | | |     |   | |   | |   |     | | |   |         |       |                 |     |   | | | |       | | |     |       | | | |     |   | | |   | | | |     | \n |   |             |   |     |   |   | | |   | | +-----|---|-|---------------|---|-------------|-------------------------|-----|---|-|-|---------|-|---------------|-|-|-|---+ |   | | |   | | | |     | \n |   |             |   |     |   |   | | |   | |       |   | |   | |   |     | | |   |         |       |                 |     |   | | | |       | | |     |       | | | |   | |   | | |   | | | |     | \n |   |             |   |     |   |   | | |   | |       |   | | +-|-|---------|---|---|---------|-------|-----------------|-----|---|---|-+ +---+ | | | +---|---------|--R----|-|---|-|-|---|---+ |     | \n |   |             |   |     |   |   | | |   | |       |   | | | | |   |     | | |   |         |       |                 |     |   | | |   |   | | | | |   |       | | | |   | |   | | |   | |   |     | \n |   | +---------------|---------|---|-|---+ | |       +-+ | | | | +---|---+ | | |   +-----------------|-----------------|-------------|---------|-|-------------------|-|-----|---|-|-|---|---+ |     | \n |   | |           |   |     |   |   | | | | | |         | | | | |     |   | | | |             |       |                 |     |   | | |   |   | | | | |   |       | | | |   | |   | | |   | | | |     | \n |   | |           |   |     |   |   | | | | +-+         | | | | |     |   | | | |             |   +---|-----------------|-----+   | +-----|-----|-----|-----------|-|---|-----|-----------|-|-|-|---+ | \n |   | |           |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |                 |         |   |   |   | | | | |   |       | | | |   | |   | | |   | | | |   | | \n |   | +-----------|---------|---|---|-------------------------|-------|---|-|-|---------------|-------|-----------------|-----+   |   +-+ |   | | | | |   |       | | | |   | |   | | |   | | | |   | | \n |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |                 |     |   |     | |   | | | | |   |       | | | |   | |   | | |   | | | |   | | \n |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         +-----------------|-------|---|-|-----|-----------|-|-|-----+ |   | | +---+ | | |   | | \n |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | \n |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | \n |   |             |   |     |   |   | | | |             | | | | |     |   | | | |             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | \n |   |           +-|---|-----|-------|-|---+             | | | | |     |   | | +-+             |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | \n |   |           | |   |     |   |   | | |               | | | | |     |   | |                 |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | \n |   |           | |   |     |   |   | | |               | | | | |     |   | |                 |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | \n |   |           | |   |     |   |   | | |               | | | | |     |   | |                 |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   | |       | | |   | | \n |   |           | |   |     |   |   | | |               | | | | |     |   | +---------------+ |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     | +-----------|-+ |   | | \n |   |           | |   |     |   |   | | |               | | | | |     |   |                 | |   |   |         |       |     |   |     | |   | | | | |   |       | | | |     | | | |       |   |   | | \n | +-------------+ |   |   +-|---|---|---|---------------------|-|-----|-----------------------+   |   |         |       |     |   |     | |   | | | | |   |       | | | |     | +-|-+       |   |   | | \n | | |             |   |   | |   |   | | |               | | | | |     |   |                 |     |   |         |       |     |   |     | |   | | | | |   |       | | | |     |   |         |   |   | | \n | | |             |   |   | |   |   | | |               | | | | |     |   |                 |     |   |         |     +-|---------|-----|-|-+ +-|-|-------|---+   | | | |     |   |         |   |   | | \n | | |             |   |   | |   |   | | |               | | | | |     |   |                 |     |   |         |     | |     |   |     | | |   | | | |   |   |   | | | |     |   |         |   |   | | \n | | |             |   |   | |   +-----------------------|-|-|-|-|-----------------------------------------------|-----+ |     |   |     | | |   | | | |   |   |   | | | |     |   |         |   |   | | \n | | |             |   |   | |       | | |               | | | | |     |   |                 |     |   |         |       |     |   |     | | |   | | | |   |   |   | | | |     |   |         |   |   | | \n | | |             |   |   | |       | | |               | | | | |     |   |   +---------------+   |   |         |       |     |   |     | | |   | | | |   |   |   | | | |   +-----|---------|---+   | | \n | | |             |   |   | |       | | |               | | | | |     |   |   |             | |   |   |         |       |     |   |     | | |   | | | |   |   |   | | | |   | |   |         |       | | \n | | |             |   |   | |       | | |       +---------|-|-|-------|---|-----------------|---+ |   |         |       +-----|-------------|---|-|-|-|---|-------|-----------|-------------------+ | | \n | | |             |   |   | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | |   | | | |   |   |   | | | |   | |   |         |     | | | \n | | |             |   | +-|-|-----------|---------------|---|-|-|---------|-----------------|---------------------------------|---|-----------+ | | | |   |   |   | | | |   | |   |         |     | | | \n | | |             |   | | | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | | | | | | |   |   |   | | | |   | |   |         |     | | | \n | +---+           |   | | | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | | | | | | |   |   +-+ | | | |   | |   |         |     | | | \n |   | |           |   | | | |       | | |       |       | | | | |     |   |   |             | | | |   |         |             |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | \n |   | |           |   | | | +-------|-|-|-------|-------|---|---|-----|---|---+           +---|-----------------+             |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | |       |       | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | |       |       | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | |       |       | | | | |     |   |               | | | | |   |                       |   |     | | Z | | C | |   |     | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | |       | +---+ | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | |       | |   | | | | | |     |   |               | | | | |   |                       |   |     | | | | | | | |   |     | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | | +-----|---------|-|-|-------------------------+ | | | | |   |                       |   |     | | | | | | | +-------+ | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       |   |     | | | | | | |     |   | | | | | |   | |   |         |     | | | \n |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       |   |     | | | | +---|---+ | F +-----|---|---------|---------------|-+ | \n |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       |   |     | | | |   | |   | | |   | | | | |   | |   |         |     |   | \n |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                       +-------+ | | | |   | |   | | |   | | | | |   | |   |         |     |   | \n |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | | | | | |   |                           |   | | | | |   | |   | | |   | | | | |   | |   |         |     |   | \n |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             | +---|-|-|---|-----------+               |   +-------|---|-|-------|-+ | | | | |   | |   |         | +---|-+ | \n |   | |           |   | | |         | | | |     | |   | | | | | |     |   |             |   | | | |   |           |               |     | | | |   | |   | | | | | | | | |   | |   |         | |   | | | \n |   | |           | +---|-----------------------|-----|-|-----|-------|---------------------------|---------------|---------------------------------|---|-|-|---|-------+   | |   |         | |   | | | \n |   | |           | | | | |         | | | |     | |   | | | | | |     |   |             |   | | | |   |           |               |     | | | |   | |   | | | | | | | |     | |   |         | |   | | | \n |   | |           | | | | |         | | | |     | |   +---|-|---------------------------|---|---------------------|-----+         +-------|-|-|-----|---|-|-|-------|-+ +---|-----------+   | |   | | | \n |   | |           | | | | |         | | | |     | |     | | | | |     |   |             |   | | | |   |           |     |               | | | |   | |   | | | | | | |   |   | |   |     |   | |   | | | \n |   | |       +---|---|---|-----------+ | |     | |     | | | | |     |   |             |   | | | |   +-----------|-----|-----------------|-|-|---|-|---------|---|---+ |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |     | |     | | | | |     |   |             |   | | | |               |     |               | | | |   | |   | | | | | | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |     +---------------|---------+             |   | | | |       +-------|---------------------|---|-------------+ +-|-+ | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |                 |   | | | |       |       |     |               | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |           +-+   |   +---|-------+ |       |     +-------------+ | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | | |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | | | |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | | +-|-------------|---------|---------|-|-------|-----------|-|---------|-|-|-------|-----------------------------|---+ |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | |   |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | |   |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | |   |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | |   |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | |   |         |   | |       |     | | | | |     |           | |   |     | | |     | |       |                   | | |   |   | |   |     |   | | | |   | |   |     |   | |   | | | \n |   | |       |   | | |   |       +-|---|-|-------|-------|-|-|-------------------|-|-+ |     | | |     | |       |                   | | |   |   | |   |     +-----|---+ +-|---------------|---+ | | | \n |   | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     | |       |                   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | \n |   | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     | |       |                   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | \n |   | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     | |       |                   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | \n | +---|-----------|-|-|-----------|-|---|-------------------|---------|--E--------|---------------|-----|-+       |       +-------+   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | \n | | | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | \n | | | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | \n | | | |       |   | | |   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         | | |   | | |   |     |   | | | | | | \n | | | +-------|---|---+   |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |         +---------|-|---+     |   | | | | | | \n | | |         |   | |     |       | |   | |       |     | | | | |     |           | | | |     | | |     |         |       |       |   | | |   |   | |   |           | |   | | |         |   | | | | | | \n | | |         |   | | +---|-------------|-|-------|-------------|-------------------+ | |     | | |     |         |       |       |   | | |   |   | |   |           | |   | | |         |   | | | | | | \n | | |         |   | | |   |       | |   | |       |     | | | | |     |           |   | |     | | |     |         |       |       |   | | |   |   | |   |           | |   | | |         |   | | | | | | \n | | |         |   | | |   |       | |   | |       |     | | | | |     |           |   | |     | | |     |         |       |       +---+ | |   |   | |   |         +-|-+   | | |         |   | | | | | | \n | | |         |   | | |   |       | |   | |       |     | | | | |     |           |   | |     | | |     |         |       |             | |   |   | |   |         | |     | | |         |   | | | | | | \n | | |         |   | | |   +---------|---|---------------|-|-|-|-|-----|---+     +-|-----------|-|-|-----------------------|-------------------|-------------------|-|-------|---+       |   | | | | | | \n | | |         |   | | |           | |   | |       |     | | | | |     |   |     | |   | |     | | |     |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | | | \n | | |         |   | | |           +-|-------------|-------|---|-------|---------------|-|-----------+   |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | | | \n | | |         |   | | |             |   | |       |     | | | | |     |   |     | |   | |     | | | |   |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | | | \n | | |     +-------|-|-|-------------------|-------|-------|---|-----------|-------------+     | +-|-|---|-----------------|-------------------|---------|-------------------|---|-----------|---|-----+ \n | | |     |   |   | | |             |   | |       |     | | | | |     |   |     | |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       |   | | | | |   \n | | |     |   |   | | | +-------------+ | |       | +---------------------|-----|-|-----------|---|-|-------------|-------|-----------+ | |   |   | |   |         | |     | | | |       | +-----|-+ |   \n | | |     |   |   | | | |           | | | |       | |   | | | | |     |   |     | |   |       |   | |   |         |       |           | | |   |   | |   |         | |     | | | |       | | | | |   |   \n | | |     |   |   | | | |   +-------------|---------+   | | | | | +---|---------|-----|-------|---|-|---------------------|-----------+ | |   |   | |   |         | |     | | | |       | | | | |   |   \n | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |     | |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       | | | | |   |   \n | | |     |   |   | | +-----|---------|-|-|-------------|---|-|-|-|-------------+ |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       | | | | | +---+ \n | | |     |   |   | |   |   |       | | | |       |     | | | | | |   |   |       |   |       |   | |   |         |       |             | |   |   | |   |         | |     | | | |       | | | | | | | | \n | | |     |   |   | | +-------------|-|-----------------|---|---|-|---|---|-------|---|-----------+ | +-|---------|--------------M------|---------------------+ +-+ |     | | | |       | | | | | | | | \n | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |     | | |         |       |             | |   |   | |   |     | |   |     | | | |       | | | | | | | | \n | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   +---|---+       |       |             | |   | +-|-----------|-|---|-----|-+ | |   +---|---|---|-|-|-+ \n | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | |   |     | |   |     |   | |   |   | | | | | | |   \n | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | +-|-----|-----------|---|-----|---|-|-|---|-|-|-+ \n | | |     |   |   | | | |   |       | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | \n | | |     |   | +-----|-|---|---+   | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | \n | | |     |   | | | | | |   |   |   | | | |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | \n | | |     |   | | | | | +---|-------|-|-+ |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | \n | | |     |   | | | | |     |   |   | |   |       |     | | | | | |   |   |       |   |       |   | | | | |       |       |             | |   | | | | | |     | |   |     |   | |   |   | | | | | | | | \n | | |     |   | | | | |     |   +---|-|---|-------|-------|-------+   +-----------|---|-------------|-|-|-|-------|-------+             | | +---|---|---|-----|-----------------+   |   | | | | | | | | \n | | |     |   | | | | |     |       | |   |       |     | | | | |         |       |   |       |   | | | | |       |                     | | | | | | | | |     | |   |     |   |     |   | | | | | | | | \n | | |     |   | | | | +---------------------------+     | | | | |         |       |   |       |   | | | | |       |       +-------------+ +-+ | | | | | |     | |   |     |   |     |   | | | | +-+ | | \n | | |     |   | | | |       |       | |   |             | | | | |         |       |   |       |   | | | | |       |       |                   | | | | | |     | |   |     |   |     |   | | | |     | | \n | | +-----|-+ | | | |       |       | |   | +-----------|-------|---------|---+   |   |       |   | | | | |       |       |           +---+ +-------|-|-+     | |   |     |   |     |   | | | |     | | \n | |       | | | | | |       |       | |   | |           | | | | |         |   |   |   |       |   | | | | |       |       |           |   | | | | | | |       | |   |     |   |     |   | | | |     | | \n | |       | | | | | |       |       | |   | |           | | | | |         |   |   |   |       |   | | | | |       |       |           |   | | | | | +-|---------|---|---------------------|-------+ | | \n | |       | | | | | |       |       | |   | |           | | | | |         |   |   |   |       |   | | | | |       |       |           |   | | | | |   |       | |   |     |   |     |   | | | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |   +-------|-------------|-------------|-----------------------|-----|-|-----------|-|-+ |     |   |     |   | | | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |       |           |   | | | | |   |       | | | |     |   |     |   | | | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |       +-+         |   | | | | |   |       | | | |     |   |     |   | | | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |         |         |   | | | | |   |       | | | |     |   |     |   | | | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |         |         | +-|-|-|-|-------------|-|-|-+     |   |     |   | | | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |       |   |       |   | | | | |       |         |         | | | | | | |   |       | | |       |   |     |   | | | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |       |   +-------|-----|-----|-----------------|---------|---|-+ | | |   |       | | |       |   |     |   +-+ | |   | | | \n | |       | | | | | |       |       | |   | |           | | | | |         |       |           |   | | | | |       |         |         | | |   | | |   |       | | |       |   |     |       | |   | | | \n | | +---------|-----------+ |       | |   | |         +-----|-----------------+   +-----------|---------|-+       |       +-|-------+ | | +---+ | |   | +-+   | +-|---------------+ |       | |   | | | \n | | |     | | | | | |     | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |       | | |       | |   | | |   |   |       |   |   | |       | |   | | | \n | | |     | | | | | |     | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |       +-|-|-------+ |   | | |   |   |       |   |   | |       | |   | | | \n | | |     | | | | | |     | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   |   |       |   |   | |       | |   | | | \n | | |     | | | | | +-------|-------------|-|---------|---|---|-|-----------------------------|-------|-|-----------------------------|-|-------------|-|-|-------|-----------------|-------|-|---|-+ | \n | | |     | | | | |       | |       | |   | |         | | | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   |   |       |   |   | |       | |   |   | \n | | |     | | | | |       | |       | |   | |         | +-|---|-|---------|-----------------------------------------------|-|-----------|---------|---|-|-------+ |       |   |   | |       | | +---+ | \n | | |     | | | | |       | |       | |   | |         |   | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   | | |       |   |   | |       | | | | | | \n | | |     | | | | |       | |       | |   | |         |   | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   | | |       |   |   | |       | | | | | | \n | | |     | | | | |       | |       | |   | |         |   | | | |         |   |               |   | | | |         |       | |         | |         |   | | |   | | |       |   |   | |       | | | | | | \n | | +-------|-----+       | |       | |   | |         |   | | | |         +---|---------------|-------|-|---------|-------------------------------|---+ | |   | | |       |   |   | |       | | | | | | \n | |       | | | |         | |       | |   | |         |   | | | |             |               |   | | | |         |       | |         | |         |     | |   | | |       |   |   | |       | | | | | | \n +-|---------|-----------------------------|-|-------------|---|---------------|-------------------|---|-|-----------------------------+ |         |   +-|-----|---|-------|-----+ | |       | | | | | | \n   |       | | | |         | |       | |   | |         |   | | | |             |               |   | | | |         |       | |           |         |   | | |   | | |       |   | | | |       | | | | | | \n   |       | | | |         | |       | +-------------------|---|-|-----------------------------|---|---|-|---------|-----------------------------------+ | |   | | |       |   | | | |       | | | | | | \n   |       | | | |         | |       |     | |         |   | | | |             |               |   | | | |         |       | |           |         |     | |   | | |       |   | | | |       | | | | | | \n   |       | | | |         | |       |     | |         |   | | | |             |               |   | | | | +---------------|-|-----------+         |     | |   +---|-----------|---|-------------+ | | | \n   |       | | | |         | |       |     | |         |   | | | |             |               |   | | | | |       |       | |                     |     | |     | |       |   | | | |       | |   | | | \n   |       | | | |         +-|-------|-----|-----------+   | | | |             |               |   | | +-|-|-------|---------|---------+           +-------|-------|---------+ | | | |       | |   | | | \n   |       | | | |           |       |     | |             | | | |             |               |   | |   | |       |       | |         |                 | |     | |       | | | | | |       | |   | | | \n   |       | | | |           |   +---|-----+ |             | | | |             |     +---------+   +-|---+ +---------------|-|---------|-----------------|-+     | |       | | | | | |       | |   | | | \n   |       | | | |           |   |   |       |             | | | |             |     |               |             |       | |         |                 |       | |       | | | | | |       | |   | | | \n   |       | | | |           |   |   |       |             | | | |             |     +-----------------------------+       +-+     +-----------------------------+ |       | | | | | | +-+   +-+   | | | \n   |       | | | |           |   |   |       |             | | | |             |                     |                             |   |                 |         |       | | | | | | | |         | | | \n   |       | | | |           |   +-----------|-------------|---+ |             |                     +---------------------------------+                 |         |       | +-+ | | | | +---+ +---+ | | \n   |       | | | |           |       |       |             | |   |             |                                                   |                     |         |       |     | | | |     | |     | | \n   |       | | | |           |       |       |             | |   +-------------|---------------------------------------------------------+               | +-------+       | +---|-|-|-|-+   +-+   +-+ | \n   |       | | | |           |       |       |             | |                 |                                                   |     |               | |               | |   | | | | |         |   | \n   |       | | | |           |       |       |             | |                 +---------------------------------------------------------|---------------------------------|-+   | | +-|-+         |   | \n   |       | | | |           |       |       |             | |                                                                     |     |               | |               |     | |   |           |   | \n   |   +-------|-+           +---------------|-------------+ |                                   +---------------------------------|-----|---------------------------------------+ |   |           |   | \n   |   |   | | |                     |       |               |                                   |                                 |     |               | |               |       |   |           |   | \n   | +-+   | +-+                     |       |               | +---------------------------------|---------------------------------------+               | |               +--Q--+ +-+ |           |   | \n   | |     |                         |       |               | |                                 |                                 |                     | |                     |   | |           |   | \n   | +-----+                         |       +---------------|-+         +-----------------------+                                 +---------------------+ +---------------------+   +-|-----------+   | \n   |                                 |                       |           |                                                                                                             |               | \n   |                                 +-----------------------+           +-------------------------------------------------------------------------------------------------------------+               | \n   |                                                                                                                                                                                                   | \n   +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ \n                                                                                                                                                                                                         \n'));
}

runPart1();
